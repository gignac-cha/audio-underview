---
file: workers/tools/sources/jwt.ts
---
_âš ï¸ Potential issue_ | _ğŸŸ¡ Minor_

**`signJWT`ê°€ `iat`/`exp` ì—†ëŠ” í˜ì´ë¡œë“œë„ ì„œëª…í•©ë‹ˆë‹¤.**

`JWTPayload` ì¸í„°í˜ì´ìŠ¤ì—ì„œ `iat`ê³¼ `exp`ê°€ í•„ìˆ˜ í•„ë“œë¡œ ì„ ì–¸ë˜ì–´ ìˆì§€ë§Œ, TypeScript íƒ€ì… ì²´í¬ë§Œìœ¼ë¡œëŠ” ëŸ°íƒ€ì„ì— ë³´ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. `verifyJWT`ì—ì„œ `exp`ê°€ ì—†ëŠ” í† í°ì€ ë§Œë£Œ ê²€ì¦ì„ ê±´ë„ˆë›°ë¯€ë¡œ(Line 76ì˜ `typeof` ì¡°ê±´), ë§Œë£Œë˜ì§€ ì•ŠëŠ” ì˜êµ¬ í† í°ì´ ìƒì„±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ„ì˜ `verifyJWT` í´ë ˆì„ ê²€ì¦ ì œì•ˆê³¼ í•¨ê»˜ í•´ê²°ë©ë‹ˆë‹¤.

<details>
<summary>ğŸ¤– Prompt for AI Agents</summary>

```
Verify each finding against the current code and only fix it if needed.

In `@workers/tools/sources/jwt.ts` around lines 42 - 52, signJWT currently signs
payloads even when iat/exp are missing which allows creating non-expiring
tokens; update signJWT to enforce/normalize these claims: inside signJWT (and
introduce a DEFAULT_JWT_EXP_SECONDS constant if needed) ensure payload.iat is
set to Math.floor(Date.now()/1000) when absent and payload.exp is set to
payload.iat + DEFAULT_JWT_EXP_SECONDS (or throw an error if your policy prefers
explicit exp), then continue signing; reference JWTPayload, signJWT, and
verifyJWT when making the change so verifyJWT's claim checks behave correctly at
runtime.
```

</details>

<!-- fingerprinting:phantom:medusa:phoenix -->

<!-- This is an auto-generated comment by CodeRabbit -->
